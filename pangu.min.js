!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("pangu",[],t):"object"==typeof exports?exports.pangu=t():e.pangu=t()}(window,function(){return a={},r.m=n=[function(h,e,v){var t,n,a;n=[],void 0===(a="function"==typeof(t=function(){"use strict";function n(e){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){n=function e(t){return typeof t}}else{n=function e(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}return n(e)}function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||false;a.configurable=true;if("value"in a)a.writable=true;Object.defineProperty(e,a.key,a)}}function i(e,t,n){if(t)r(e.prototype,t);if(n)r(e,n);return e}function o(e,t){if(t&&(n(t)==="object"||typeof t==="function")){return t}return c(e)}function c(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function s(e){s=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)};return s(e)}function u(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:true,configurable:true}});if(t)p(e,t)}function p(e,t){p=Object.setPrototypeOf||function e(t,n){t.__proto__=n;return t};return p(e,t)}var e,t;function f(t){var n=this,a=arguments;var r=false;return function(){if(r){return}var e=n;r=true;t.apply(e,a)}}function g(a,r,i){var o=this,c=arguments;var s=null;var u=null;return function(){var e=o;var t=c;var n=+new Date;clearTimeout(s);if(!u){u=n}if(n-u>=i){a.apply(e,t);u=n}else{s=setTimeout(function(){a.apply(e,t)},r)}}}var l=function(e){u(t,e);function t(){var e;a(this,t);e=o(this,s(t).call(this));e.blockTags=/^(div|p|h1|h2|h3|h4|h5|h6)$/i;e.ignoredTags=/^(script|code|pre|textarea)$/i;e.presentationalTags=/^(b|code|del|em|i|s|strong|kbd)$/i;e.spaceLikeTags=/^(br|hr|i|img|pangu)$/i;e.spaceSensitiveTags=/^(a|del|pre|s|strike|u)$/i;e.isAutoSpacingPageExecuted=false;return e}i(t,[{key:"isContentEditable",value:function e(t){return t.isContentEditable||t.getAttribute&&t.getAttribute("g_editable")==="true"}},{key:"isSpecificTag",value:function e(t,n){return t&&t.nodeName&&t.nodeName.search(n)>=0}},{key:"isInsideSpecificTag",value:function e(t,n){var a=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var r=t;if(a){if(this.isSpecificTag(r,n)){return true}}while(r.parentNode){r=r.parentNode;if(this.isSpecificTag(r,n)){return true}}return false}},{key:"canIgnoreNode",value:function e(t){var n=t;if(n&&(this.isSpecificTag(n,this.ignoredTags)||this.isContentEditable(n))){return true}while(n.parentNode){n=n.parentNode;if(n&&(this.isSpecificTag(n,this.ignoredTags)||this.isContentEditable(n))){return true}}return false}},{key:"isFirstTextChild",value:function e(t,n){var a=t.childNodes;for(var r=0;r<a.length;r++){var i=a[r];if(i.nodeType!==Node.COMMENT_NODE&&i.textContent){return i===n}}return false}},{key:"isLastTextChild",value:function e(t,n){var a=t.childNodes;for(var r=a.length-1;r>-1;r--){var i=a[r];if(i.nodeType!==Node.COMMENT_NODE&&i.textContent){return i===n}}return false}},{key:"spacingNodeByXPath",value:function e(t,n){if(!(n instanceof Node)||n instanceof DocumentFragment){return}var a=document.evaluate(t,n,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);var r;var i;for(var o=a.snapshotLength-1;o>-1;--o){r=a.snapshotItem(o);if(this.isSpecificTag(r.parentNode,this.presentationalTags)&&!this.isInsideSpecificTag(r.parentNode,this.ignoredTags)){var c=r.parentNode;if(c.previousSibling){var s=c.previousSibling;if(s.nodeType===Node.TEXT_NODE){var u=s.data.substr(-1)+r.data.toString().charAt(0);var p=this.spacing(u);if(u!==p){s.data="".concat(s.data," ")}}}if(c.nextSibling){var l=c.nextSibling;if(l.nodeType===Node.TEXT_NODE){var f=r.data.substr(-1)+l.data.toString().charAt(0);var g=this.spacing(f);if(f!==g){l.data=" ".concat(l.data)}}}}if(this.canIgnoreNode(r)){i=r;continue}var d=this.spacing(r.data);if(r.data!==d){r.data=d}if(i){if(r.nextSibling&&r.nextSibling.nodeName.search(this.spaceLikeTags)>=0){i=r;continue}var h=r.data.toString().substr(-1)+i.data.toString().substr(0,1);var v=this.spacing(h);if(v!==h){var y=i;while(y.parentNode&&y.nodeName.search(this.spaceSensitiveTags)===-1&&this.isFirstTextChild(y.parentNode,y)){y=y.parentNode}var b=r;while(b.parentNode&&b.nodeName.search(this.spaceSensitiveTags)===-1&&this.isLastTextChild(b.parentNode,b)){b=b.parentNode}if(b.nextSibling){if(b.nextSibling.nodeName.search(this.spaceLikeTags)>=0){i=r;continue}}if(b.nodeName.search(this.blockTags)===-1){if(y.nodeName.search(this.spaceSensitiveTags)===-1){if(y.nodeName.search(this.ignoredTags)===-1&&y.nodeName.search(this.blockTags)===-1){if(i.previousSibling){if(i.previousSibling.nodeName.search(this.spaceLikeTags)===-1){i.data=" ".concat(i.data)}}else{if(!this.canIgnoreNode(i)){i.data=" ".concat(i.data)}}}}else if(b.nodeName.search(this.spaceSensitiveTags)===-1){r.data="".concat(r.data," ")}else{var m=document.createElement("pangu");m.innerHTML=" ";if(y.previousSibling){if(y.previousSibling.nodeName.search(this.spaceLikeTags)===-1){y.parentNode.insertBefore(m,y)}}else{y.parentNode.insertBefore(m,y)}if(!m.previousElementSibling){if(m.parentNode){m.parentNode.removeChild(m)}}}}}}i=r}}},{key:"spacingNode",value:function e(t){var n=".//*/text()[normalize-space(.)]";if(t.children&&t.children.length===0){n=".//text()[normalize-space(.)]"}this.spacingNodeByXPath(n,t)}},{key:"spacingElementById",value:function e(t){var n='id("'.concat(t,'")//text()');this.spacingNodeByXPath(n,document)}},{key:"spacingElementByClassName",value:function e(t){var n='//*[contains(concat(" ", normalize-space(@class), " "), "'.concat(t,'")]//text()');this.spacingNodeByXPath(n,document)}},{key:"spacingElementByTagName",value:function e(t){var n="//".concat(t,"//text()");this.spacingNodeByXPath(n,document)}},{key:"spacingPageTitle",value:function e(){var t="/html/head/title/text()";this.spacingNodeByXPath(t,document)}},{key:"spacingPageBody",value:function e(){var t="/html/body//*/text()[normalize-space(.)]";["script","style","textarea"].forEach(function(e){t="".concat(t,'[translate(name(..),"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")!="').concat(e,'"]')});this.spacingNodeByXPath(t,document)}},{key:"spacingPage",value:function e(){this.spacingPageTitle();this.spacingPageBody()}},{key:"autoSpacingPage",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1e3;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:500;var a=arguments.length>2&&arguments[2]!==undefined?arguments[2]:2e3;if(!(document.body instanceof Node)){return}if(this.isAutoSpacingPageExecuted){return}this.isAutoSpacingPageExecuted=true;var r=this;var i=f(function(){r.spacingPage()});var o=document.getElementsByTagName("video");if(o.length===0){setTimeout(function(){i()},t)}else{for(var c=0;c<o.length;c++){var s=o[c];if(s.readyState===4){setTimeout(function(){i()},3e3);break}s.addEventListener("loadeddata",function(){setTimeout(function(){i()},4e3)})}}var u=[];var p=g(function(){while(u.length){var e=u.shift();if(e){r.spacingNode(e)}}},n,{maxWait:a});var l=new MutationObserver(function(e,t){e.forEach(function(e){switch(e.type){case"childList":e.addedNodes.forEach(function(e){if(e.nodeType===Node.ELEMENT_NODE){u.push(e)}else if(e.nodeType===Node.TEXT_NODE){u.push(e.parentNode)}});break;case"characterData":var t=e.target;if(t.nodeType===Node.TEXT_NODE){u.push(t.parentNode)}break;default:break}});p()});l.observe(document.body,{characterData:true,childList:true,subtree:true})}}]);return t}(v(1).Pangu),d=new l;h.exports=d,h.exports.default=d,h.exports.Pangu=l})?t.apply(e,n):t)||(h.exports=a)},function(B,e,t){var n,a,r;a=[],void 0===(r="function"==typeof(n=function(){"use strict";function a(e){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){a=function e(t){return typeof t}}else{a=function e(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}return a(e)}function t(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||false;a.configurable=true;if("value"in a)a.writable=true;Object.defineProperty(e,a.key,a)}}function n(e,t,n){if(t)r(e.prototype,t);if(n)r(e,n);return e}var e="⺀-⻿⼀-⿟぀-ゟ゠-ヺー-ヿ㄀-ㄯ㈀-㋿㐀-䶿一-鿿豈-﫿",o=new RegExp("[".concat(e,"]")),c=new RegExp("([".concat(e,"])[ ]*([\\:]+|\\.)[ ]*([").concat(e,"])"),"g"),s=new RegExp("([".concat(e,"])[ ]*([~\\!;,\\?]+)[ ]*"),"g"),u=new RegExp("([\\.]{2,}|…)([".concat(e,"])"),"g"),p=new RegExp("([".concat(e,"])\\:([A-Z0-9\\(\\)])"),"g"),l=new RegExp("([".concat(e,'])([`"״])'),"g"),f=new RegExp('([`"״])(['.concat(e,"])"),"g"),g=/([`"\u05f4]+)[ ]*(.+?)[ ]*([`"\u05f4]+)/g,d=new RegExp("([".concat(e,"])('[^s])"),"g"),h=new RegExp("(')([".concat(e,"])"),"g"),v=new RegExp("([A-Za-z0-9".concat(e,"])( )('s)"),"g"),y=new RegExp("([".concat(e,"])(#)([").concat(e,"]+)(#)([").concat(e,"])"),"g"),b=new RegExp("([".concat(e,"])(#([^ ]))"),"g"),m=new RegExp("(([^ ])#)([".concat(e,"])"),"g"),T=new RegExp("([".concat(e,"])([\\+\\-\\*\\/=&\\|<>])([A-Za-z0-9])"),"g"),N=new RegExp("([A-Za-z0-9])([\\+\\-\\*\\/=&\\|<>])([".concat(e,"])"),"g"),x=/([/]) ([a-z\-_\./]+)/g,$=/([/\.])([A-Za-z\-_\./]+) ([/])/g,E=new RegExp("([".concat(e,"])([\\(\\[\\{<>“])"),"g"),S=new RegExp("([\\)\\]\\}<>”])([".concat(e,"])"),"g"),w=/([\(\[\{<\u201c]+)[ ]*(.+?)[ ]*([\)\]\}>\u201d]+)/,k=new RegExp("([A-Za-z0-9".concat(e,"])[ ]*([“])([A-Za-z0-9").concat(e,"\\-_ ]+)([”])"),"g"),P=new RegExp("([“])([A-Za-z0-9".concat(e,"\\-_ ]+)([”])[ ]*([A-Za-z0-9").concat(e,"])"),"g"),O=/([A-Za-z0-9])([\(\[\{])/g,_=/([\)\]\}])([A-Za-z0-9])/g,R=new RegExp("([".concat(e,"])([A-Za-zͰ-Ͽ0-9@\\$%\\^&\\*\\-\\+\\\\=\\|/¡-ÿ⅐-↏✀—➿])"),"g"),A=new RegExp("([A-Za-zͰ-Ͽ0-9~\\$%\\^&\\*\\-\\+\\\\=\\|/!;:,\\.\\?¡-ÿ⅐-↏✀—➿])([".concat(e,"])"),"g"),j=/(%)([A-Za-z])/g,z=/([ ]*)([\u00b7\u2022\u2027])([ ]*)/g,i=function(){function e(){t(this,e);this.version="4.0.7"}n(e,[{key:"convertToFullwidth",value:function e(t){return t.replace(/~/g,"～").replace(/!/g,"！").replace(/;/g,"；").replace(/:/g,"：").replace(/,/g,"，").replace(/\./g,"。").replace(/\?/g,"？")}},{key:"spacing",value:function e(t){if(typeof t!=="string"){console.warn("spacing(text) only accepts string but got ".concat(a(t)));return t}if(t.length<=1||!o.test(t)){return t}var i=this;var n=t;n=n.replace(c,function(e,t,n,a){var r=i.convertToFullwidth(n);return"".concat(t).concat(r).concat(a)});n=n.replace(s,function(e,t,n){var a=i.convertToFullwidth(n);return"".concat(t).concat(a)});n=n.replace(u,"$1 $2");n=n.replace(p,"$1：$2");n=n.replace(l,"$1 $2");n=n.replace(f,"$1 $2");n=n.replace(g,"$1$2$3");n=n.replace(d,"$1 $2");n=n.replace(h,"$1 $2");n=n.replace(v,"$1's");n=n.replace(y,"$1 $2$3$4 $5");n=n.replace(b,"$1 $2");n=n.replace(m,"$1 $3");n=n.replace(T,"$1 $2 $3");n=n.replace(N,"$1 $2 $3");n=n.replace(x,"$1$2");n=n.replace($,"$1$2$3");n=n.replace(E,"$1 $2");n=n.replace(S,"$1 $2");n=n.replace(w,"$1$2$3");n=n.replace(k,"$1 $2$3$4");n=n.replace(P,"$1$2$3 $4");n=n.replace(O,"$1 $2");n=n.replace(_,"$1 $2");n=n.replace(R,"$1 $2");n=n.replace(A,"$1 $2");n=n.replace(j,"$1 $2");n=n.replace(z,"・");return n}},{key:"spacingText",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:function(){};var a;try{a=this.spacing(t)}catch(e){n(e);return}n(null,a)}},{key:"spacingTextSync",value:function e(t){return this.spacing(t)}}]);return e}(),C=new i;B.exports=C,B.exports.default=C,B.exports.Pangu=i})?n.apply(e,a):n)||(B.exports=r)}],r.c=a,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0);function r(e){if(a[e])return a[e].exports;var t=a[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}var n,a});
